;KWARC = 11 059 200 = LICZBA CYKLI ZEGAROWYCH W CZASIE 1SEK
;11 059 200 / 12 = 921 600  <--- cykli maszynowych na 1s
;*TRYB TIMERA = 8BITOW
;TRYB TIMERA = 16BITOW
;*TRYB TIMERA = 32BITOW
;*TRYB TIMERA = 64BITOW
;WYBOR TRYBU =


T0_VAL_POCZ EQU 65535-9215
TH0_POCZ	EQU T0_VAL_POCZ / 256
TL0_POCZ	EQU T0_VAL_POCZ MOD 256

LICZNIK_PROGRAMOWY	DATA 045h

	ORG 0000h
_RESET:
	LJMP _INIT
	
	ORG 000Bh
_OVRFL:
	MOV TH0,#TH0_POCZ
	INC LICZNIK_PROGRAMOWY
	LJMP _LOOP

	ORG 0100h
_INIT:
	MOV LICZNIK_PROGRAMOWY.#0d
	
	;USTAWIC TMOD
	;TRYB NAJMLODSZY 2 BIT[01]
	;GATE=0 -	IGORUJE LINIE INIT[0]
	;C/T=0 - 	LICZNIK CZY CZASOMIERZ? 0=CZASOMIERZ[0]
	MOV TMOD,#00000001b

	;UMIESCIC WARTOSC DO THO 1 TLO
	;TRYB 1 16BITOWY MAKSYMALNA WARTOSC TO 65 536 - 9216
	;65 536 - 9216=56320
	MOV TH0,#TH0_POCZ
	MOV TL0,#TL0_POCZ

	;URUCHOMIENIE OBSLUGI INIT_OD_T0
	SETB EA
	SETB ET0

	;FLAGA PRZEPELNIENIA-WYCZYSCIC
	CLR TF0

	;URUCHOMIENIE LICZNIKA=
	SETB TR0

	NOP

_LOOP:
	;LICZNIK_PROGRAMOWY
	MOV A,#99d
	CLR C
	SUBB A,LICZNIK_PROGRAMOWY
	JNC _LOOP

	CLR C
	MOV A, LICZNIK_PROGRAMOWY
	SUBB A,#100d
	MOV LICZNIK_PROGRAMOWY, A

	CPL P1.7	

	LJMP _LOOP


END